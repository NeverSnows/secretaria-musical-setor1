data = [
    {
        church: '<a href="https://goo.gl/maps/G7Qn7CaX9ryRgVPN8">Agua Rasa</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '3º sáb. às 17:00h', hour: '17:00', week: '3', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/oZWGJamfHD1yu36K6">Americanópolis</a>',
        gem: { textDay: '4º sex. às 20:00h', hour: '20:00', week: '4', dayOfWeek: '5' },
        local: { textDay: '2º sáb. às 17:00h', hour: '17:00', week: '2', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/q38firHnsG44yPJS9">Baixada do Glicério</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '1º sáb. às 17:00h', hour: '17:00', week: '1', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/h5k5VATu1q4Dbncz6">Barra Funda</a>',
        gem: { textDay: 'último sab. às 14:30h', hour: '14:30', week: 'last', dayOfWeek: '6' },
        local: { textDay: '1º dom. às 16:00h', hour: '16:00', week: '1', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/gp4VdETQsbRZiH4x9">Belém</a>',
        gem: { textDay: '2ª sex. às 19:30h', hour: '19:30', week: '2', dayOfWeek: '5' },
        local: { textDay: '4º sáb. às 19:30h', hour: '19:30', week: '4', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/DCdi4MBDcd7aV8TW8">Bom Retiro</a>',
        gem: { textDay: 'todo o dom. às 09:10h <b>(final do GEM)</b>', hour: '09:10', week: 'all', dayOfWeek: '0' },
        local: { textDay: '1º sáb. às 17:00h', hour: '17:00', week: '1', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/YiyrRsnXudyENdie6">Bosque da Saúde</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: 'último dom. às 16:00h', hour: '16:00', week: 'last', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/u93cJ55CEZTMGcrLA">Brás</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/nxgr3wYUK98JD9aH7">Canindé</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '2º sáb. às 16h30h', hour: '', week: '2', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/nsYJQV9yiVCrbrHm8">Caraguatá</a>',
        gem: { textDay: '1º sáb. às 15:30h <b>(final do GEM)</b>', hour: '15:30', week: '1', dayOfWeek: '6' },
        local: { textDay: '1º dom. às 16:00h', hour: '16:00', week: '1', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/PfxX3rWpAdvDpepP9">Flor da Vila Formosa</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '3º sáb. às 17:00h', hour: '17:00', week: '3', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/j5YGNgbdPyehFMUi6">Ipiranga</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '4º sáb. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/x1dM8vfsD8CH9LRbA">Jabaquara</a>',
        gem: { textDay: 'última qui. às 19:30h', hour: '19:30', week: 'last', dayOfWeek: '4' },
        local: { textDay: 'último sáb. às 19:30h', hour: '19:30', week: 'last', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/x1dM8vfsD8CH9LRbA">Jardim da Glória</a>',
        gem: { textDay: '2º sáb. às 17:00h', hour: '17:00', week: '2', dayOfWeek: '6' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/oBvAgiFfnpestN4c8">Jardim Elba</a>',
        gem: { textDay: '2º sáb. às 15:00h', hour: '15:00', week: '2', dayOfWeek: '6' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/h6uKTbYrhtYYaYVHA">Jardim Independência</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '2º sáb. às 19:30h', hour: '19:30', week: '2', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/LfUxnUYqHgKgxWBZ9">Jardim Maria Estela</a>',
        gem: { textDay: '3º sáb. às 16:00h', hour: '16:00', week: '3', dayOfWeek: '6' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/csf7kQ4wHnYJczLAA">Jardim Mimar</a>',
        gem: { textDay: '3ª ter. às 20:00h', hour: '20:00', week: '3', dayOfWeek: '2' },
        local: { textDay: '3º sáb. às 19:30h', hour: '19:30', week: '3', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/Cwfc231pLXe2SJHp8">Jardim Panorama</a>',
        gem: { textDay: '3º sáb. às 14:30h', hour: '14:30', week: '3', dayOfWeek: '6' },
        local: { textDay: 'último dom. às 16:00h', hour: '16:00', week: 'last', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/umzXqZ6dCfM4BEhj9">Jardim Planalto</a>',
        gem: { textDay: '3ª sex. às 20:00h', hour: '20:00', week: '3', dayOfWeek: '5' },
        local: { textDay: '1º dom. às 16:00h', hour: '16:00', week: '1', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/64iYaNrSfnaQ94uE7">Jardim Santo Eduardo</a>',
        gem: { textDay: '3ª sex. às 19:30h', hour: '19:30', week: '3', dayOfWeek: '5' },
        local: { textDay: '1º sáb. às 17:00h', hour: '17:00', week: '1', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/45xcGxTEdY7NPyabA">Jardim São Roberto</a>',
        gem: { textDay: '1º sáb. às 10:30h <b>(final do GEM)</b>', hour: '10:30', week: '1', dayOfWeek: '6' },
        local: { textDay: 'último dom. às 16:00h', hour: '16:00', week: 'last', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/rS7zFcXcya9jzF8u5">Jardim São Savério</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: 'último dom. às 16:00h', hour: '16:00', week: 'last', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/jKsr23T8JJPRZa7R6">Jardim Yara</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '3º sáb. às 19:30h', hour: '19:30', week: '3', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/SQCfco2fdc1QDnTi6">Parque Santa Madalena</a>',
        gem: { textDay: 'última qui. às 20:00h', hour: '20:00', week: 'last', dayOfWeek: '4' },
        local: { textDay: '4º sex. às 20:00h', hour: '20:00', week: '4', dayOfWeek: '5' }
    },
    {
        church: '<a href="https://goo.gl/maps/SD2DpycwXu1JkHjx8">Parque São Lucas</a>',
        gem: { textDay: 'última qua. às 19:30h', hour: '19:30', week: 'last', dayOfWeek: '3' },
        local: { textDay: '1º sáb. às 16:30h', hour: '16:30', week: '1', dayOfWeek: '6' }
    },
    {
        church: 'Parque Sevilha',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: 'Não tem ensaio', hour: '', week: '', dayOfWeek: '' }
    },
    {
        church: '<a href="https://goo.gl/maps/PA9dgQGcpQz6LpBE6">Ponte Pequena</a>',
        gem: { textDay: '1º sáb. às 15:00h', hour: '15:00', week: '1', dayOfWeek: '6' },
        local: { textDay: '3º qua. às 19:30h', hour: '19:30', week: '3', dayOfWeek: '3' }
    },
    {
        church: '<a href="https://goo.gl/maps/PA9dgQGcpQz6LpBE6">São João Clímaco</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '4º sáb. às 17:00h', hour: '17:00', week: '4', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/snikN2xpT5XDMj1LA">Sapopemba</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '1º sex. às 19:30h', hour: '19:30', week: '1', dayOfWeek: '5' }
    },
    {
        church: '<a href="https://goo.gl/maps/qH8TFubXB8QwQN57A">Sítio Pinheirinho</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '3º sáb. às 19:30h', hour: '19:30', week: '3', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/9oS1haexWvDVWzW3A">Vila Alpina</a>',
        gem: { textDay: '3ª sex. às 19:30h', hour: '19:30', week: '3', dayOfWeek: '5' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/27V1jJiFeu8gJTPB6">Vila Arapuá</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '1º dom. às 16:00h', hour: '16:00', week: '1', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/SVZoZkWf3p7i5wif9">Vila Bela</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '1º sex. às 19:30h', hour: '19:30', week: '1', dayOfWeek: '5' }
    },
    {
        church: '<a href="https://goo.gl/maps/SVZoZkWf3p7i5wif9">Vila California</a>',
        gem: { textDay: 'última qua. às 20:00h', hour: '20:00', week: 'last', dayOfWeek: '3' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/cKUZJHp1abKdBksx6">Vila Carioca</a>',
        gem: { textDay: '1ª seg. às 19:30h', hour: '19:30', week: '1', dayOfWeek: '1' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/524qYBqrHHKXzVHGA">Vila Clara</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/utTnvA1AbMqRy87CA">Vila Diva</a>',
        gem: { textDay: 'todo o sáb. às 16:00h <b>(final do GEM)</b>', hour: '16:00', week: 'all', dayOfWeek: '6' },
        local: { textDay: 'último sáb. às 17:00h', hour: '17:00', week: 'last', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/8iaoff3gQGLGvUSH8">Vila Ema</a>',
        gem: { textDay: 'última ter. às 19:30h', hour: '19:30', week: 'last', dayOfWeek: '2' },
        local: { textDay: '2º sáb. às 19:30h', hour: '19:30', week: '2', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/3uomPagvm6kXvm84A">Vila Formosa</a>',
        gem: { textDay: 'último dom. às 09:00h', hour: '09:00', week: 'last', dayOfWeek: '0' },
        local: { textDay: '1º dom. às 16:30h', hour: '16:30', week: '1', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/N3BFzosEHCgZuk1t6">Vila Guarani</a>',
        gem: { textDay: 'todo o sáb. às 16:30h <b>(final do GEM)</b>', hour: '16:30', week: 'all', dayOfWeek: '6' },
        gemAlt: { textDay: '</br><span class="red">2º Sábado ensaio local às 17:00h</span>', hour: '17:00', week: '2', dayOfWeek: '6' },
        local: { textDay: '2º sáb. às 17:00h', hour: '17:00', week: '2', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/XiQgY2V7DPtrQeVK8">Vila Independência</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: '4º dom. às 16:00h', hour: '16:00', week: '4', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/gGU86mzDkABGvJLV6">Vila Livieiro</a>',
        gem: { textDay: '3ª seg. às 19:30h', hour: '19:30', week: '3', dayOfWeek: '1' },
        local: { textDay: 'último dom. às 16:00h', hour: '16:00', week: 'last', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/7G3yLP3jbkZUayz89">Vila Mariana</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: 'último dom. às 16:00h', hour: '16:00', week: 'last', dayOfWeek: '0' }
    },
    {
        church: '<a href="https://goo.gl/maps/LvpTgn7gaPMuFzcm9">Vila Moraes</a>',
        gem: { textDay: '', hour: '', week: '', dayOfWeek: '' },
        local: { textDay: 'último sáb. às 17:00h', hour: '17:00', week: 'last', dayOfWeek: '6' }
    },
    {
        church: '<a href="https://goo.gl/maps/JnjjXa4nJMhesvJd8">Vila Prudente</a>',
        gem: { textDay: 'última seg. às 19:30h', hour: '19:30', week: 'last', dayOfWeek: '1' },
        local: { textDay: '2º sex. às 19:30h', hour: '19:30', week: '2', dayOfWeek: '5' }
    },
    {
        church: '<a href="https://goo.gl/maps/D8KR16teYmprGFBn6">Vila Rio Branco</a>',
        gem: { textDay: 'toda a seg. às 20:30h <b>(final do GEM)</b>', hour: '20:30', week: 'all', dayOfWeek: '1' },
        local: { textDay: '1º sab. às 19:30h', hour: '19:30', week: '1', dayOfWeek: '6' }
    },
];

data.forEach(element => {
    if(element.gem.textDay != ""){
        let church = 
        `<tr>
            <td>
                ${element.church}
            </td>
            <td>
                ${element.gem?.textDay}
            </td>
            <td>
                teste
            </td>
        </tr>`

        $("#tb_gem").append(church)
    }

    if(element.local.textDay != ""){
        let church = 
        `<tr>
            <td>
                ${element.church}
            </td>
            <td>
                ${element.local?.textDay}
            </td>
            <td>
                ${element.local?.day}
            </td>
        </tr>`

        $("#tb_local").append(church)
    }
});

$(document).ready(function() {
    $('#data_gem').DataTable( {
        rowReorder: {
            selector: 'td:nth-child(2)'
        },
        responsive: true,
        paging: false,
        language: {
            search: "Pesquisar:",
            lengthMenu: "Show _MENU_ entries",
            info: "Mostrando _TOTAL_ igreja(s)",
            infoEmpty: "Mostrando 0 igreja",
            infoFiltered: "(Filtradas de _MAX_)",
            zeroRecords: "Nenhuma igreja encontrada",
        },
    } );

    $('#data_local').DataTable( {
        rowReorder: {
            selector: 'td:nth-child(2)'
        },
        responsive: true,
        paging: false,
        language: {
            search: "Pesquisar:",
            lengthMenu: "Show _MENU_ entries",
            info: "Mostrando _TOTAL_ igreja(s)",
            infoEmpty: "Mostrando 0 igreja",
            infoFiltered: "(Filtradas de _MAX_)",
            zeroRecords: "Nenhuma igreja encontrada",
        },
    } );
} );


function getNextWeekDay(week, dayOfWeek){
    let date;
    switch(week){
        case '1': date = getDayOfSpecificWeek(1, dayOfWeek); break;
        case '2': date = getDayOfSpecificWeek(2, dayOfWeek); break;
        case '3': date = getDayOfSpecificWeek(3, dayOfWeek); break;
        case '4': date = getDayOfSpecificWeek(4, dayOfWeek); break;
        case 'all': date = getDayOfNextWeek(dayOfWeek); break;
        case 'last': date = getDayOfLastWeek(dayOfWeek); break;
        default: console.error("Invalid Week");
    }
}

//I have no fucking clue how i'm gonna do this.
function getDayOfSpecificWeek(targetWeekOfMonth, targetDayOfWeek){
    let currentDate = new Date();
    const currentWeekOfMonth = Math.ceil(currentDate.getDate() / 7);
    let nextMonth;
    let nextDay;
    let finalDate;

    if(currentWeekOfMonth < targetWeekOfMonth || (currentWeekOfMonth == targetWeekOfMonth && currentDate.getDay() <= targetDayOfWeek)){
        nextMonth = currentDate.getMonth();

        //nextDay = (targetWeekOfMonth * 7) - 7 + targetDayOfWeek;

    }else{
        nextMonth = currentDate.getMonth() + 1;

    }

    finalDate = new Date(currentDate.getFullYear, nextMonth, nextDay);

    return finalDate;
}

function getDayOfNextWeek(dayOfWeek){

}

function getDayOfLastWeek(dayOfWeek){

}

function setDataAtributes(){
    data.forEach(church =>{
        if(church.hasOwnProperty("gem")){
            //fucking week handler
            if(church.gem.textDay.search("1º") != -1 || church.gem.textDay.search("1ª") != -1 ){
                church.gem.week = "1";
            }else if(church.gem.textDay.search("2º") != -1 || church.gem.textDay.search("2ª") != -1 ){
                church.gem.week = "2";
            }else if(church.gem.textDay.search("3º") != -1 || church.gem.textDay.search("3ª") != -1 ){
                church.gem.week = "3";
            }else if(church.gem.textDay.search("4º") != -1 || church.gem.textDay.search("4ª") != -1 ){
                church.gem.week = "4";
            }else if(church.gem.textDay.search("últim") != -1){
                church.gem.week = "last";
            }else if(church.gem.textDay.search("tod") != -1){
                church.gem.week = "all";
            }

            //fucking hour handler
            const hourIndex = church.gem.textDay.search(":");
            if(hourIndex != -1){
                church.gem.hour = church.gem.textDay.slice(hourIndex - 2, hourIndex + 3);
            }

            //fucking dayOfWeek handler
            if(church.gem.textDay.search("seg") != -1){
                church.gem.dayOfWeek = "1";
            }else if(church.gem.textDay.search("ter") != -1 ){
                church.gem.dayOfWeek = "2";
            }else if(church.gem.textDay.search("qua") != -1){
                church.gem.dayOfWeek = "3";
            }else if(church.gem.textDay.search("qui") != -1){
                church.gem.dayOfWeek = "4";
            }else if(church.gem.textDay.search("sex") != -1){
                church.gem.dayOfWeek = "5";
            }else if(church.gem.textDay.search("sáb") != -1){
                church.gem.dayOfWeek = "6";
            }else if(church.gem.textDay.search("dom") != -1){
                church.gem.dayOfWeek = "7";
            }

        }
        if(church.hasOwnProperty("local")){
            //fucking week handler
            if(church.local.textDay.search("1º") != -1 || church.local.textDay.search("1ª") != -1 ){
                church.local.week = "1";
            }else if(church.local.textDay.search("2º") != -1 || church.local.textDay.search("2ª") != -1 ){
                church.local.week = "2";
            }else if(church.local.textDay.search("3º") != -1 || church.local.textDay.search("3ª") != -1 ){
                church.local.week = "3";
            }else if(church.local.textDay.search("4º") != -1 || church.local.textDay.search("4ª") != -1 ){
                church.local.week = "4";
            }else if(church.local.textDay.search("últim") != -1){
                church.local.week = "last";
            }else if(church.local.textDay.search("tod") != -1){
                church.local.week = "all";
            }

            //fucking hour handler
            const hourIndex = church.local.textDay.search(":");
            if(hourIndex != -1){
                church.local.hour = church.local.textDay.slice(hourIndex - 2, hourIndex + 3);
            }

            //fucking dayOfWeek handler
            if(church.local.textDay.search("seg") != -1){
                church.local.dayOfWeek = "1";
            }else if(church.local.textDay.search("ter") != -1 ){
                church.local.dayOfWeek = "2";
            }else if(church.local.textDay.search("qua") != -1){
                church.local.dayOfWeek = "3";
            }else if(church.local.textDay.search("qui") != -1){
                church.local.dayOfWeek = "4";
            }else if(church.local.textDay.search("sex") != -1){
                church.local.dayOfWeek = "5";
            }else if(church.local.textDay.search("sáb") != -1){
                church.local.dayOfWeek = "6";
            }else if(church.local.textDay.search("dom") != -1){
                church.local.dayOfWeek = "7";
            }
        }
        
    });

    console.log(data);
}

function printNewData(){
    let outputString = "[\n";    

    data.forEach(church =>{
        outputString += "{\nchurch: '" + church.church + 
        "', \ngem:{textDay: '" + church.gem.textDay + "', hour: '" + church.gem.hour + "', week: '" + church.gem.week + "', dayOfWeek: '" + church.gem.dayOfWeek +
         "'},\nlocal:{textDay: '" + church.local.textDay + "', hour: '" + church.local.hour + "', week: '" + church.local.week + "', dayOfWeek: '" + church.local.dayOfWeek +
        "'}\n},\n"
    });

    outputString += "];";

    console.log(outputString);
}

